{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pc\\\\Desktop\\\\asira_core\\\\src\\\\components\\\\rolePermission\\\\rolePermissionAdd.js\";\nimport React from 'react';\nimport Cookies from 'universal-cookie';\nimport { Redirect } from 'react-router-dom';\nimport Loader from 'react-loader-spinner';\nimport CheckBox from '../subComponent/CheckBox';\nimport DropDown from '../subComponent/DropDown';\nimport swal from 'sweetalert';\nimport { createStructuredSelector } from 'reselect';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router';\nimport { withStyles } from '@material-ui/styles';\nimport { compose } from 'redux';\nimport { listAllRolePermission } from './../global/globalConstant';\nimport { getAllRoleFunction, getAllRolePermissionAddFunction, postRolePermissionFunction } from './saga';\nimport { constructRolePermission } from './function';\n\nconst styles = theme => ({\n  container: {\n    flexGrow: 1\n  }\n});\n\nconst cookie = new Cookies();\n\nclass rolePermissionAdd extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this._isMounted = false;\n    this.state = {\n      diKlik: false,\n      errorMessage: '',\n      listAllRolePermission,\n      listRolePermission: [],\n      disabled: false,\n      role: '',\n      listRole: [],\n      loading: true\n    };\n\n    this.refresh = async function () {\n      const param = {};\n      const data = await getAllRoleFunction(param, getAllRolePermissionAddFunction);\n\n      if (data) {\n        if (!data.error) {\n          this.setState({\n            listRole: data.dataRole,\n            role: data.role,\n            loading: false\n          });\n        } else {\n          this.setState({\n            errorMessage: data.error,\n            disabled: true,\n            loading: false\n          });\n        }\n      }\n    };\n\n    this.btnCancel = () => {\n      this.setState({\n        diKlik: true\n      });\n    };\n\n    this.btnSave = () => {\n      if (this.state.listRolePermission.length === 0) {\n        this.setState({\n          errorMessage: \"ERROR : Data Role Permission Tidak Boleh Kosong\"\n        });\n      } else if (this.state.listRole.length === 0 || this.state.role === 0) {\n        this.setState({\n          errorMessage: \"ERROR : Data Role Tidak Boleh Kosong\"\n        });\n      } else {\n        const listRolePermission = this.state.listRolePermission;\n        const dataRolePermission = {};\n        dataRolePermission.role_id = parseInt(this.state.role);\n        dataRolePermission.permissions = constructRolePermission(listRolePermission);\n        const param = {\n          dataRolePermission\n        };\n        this.postRolePermission(param);\n      }\n    };\n\n    this.postRolePermission = async function (param) {\n      const data = await postRolePermissionFunction(param);\n      this.setState({\n        loading: true\n      });\n\n      if (data) {\n        if (!data.error) {\n          swal(\"Success\", \"Role Permission berhasil di tambah\", \"success\");\n          this.setState({\n            diKlik: true,\n            loading: false\n          });\n        } else {\n          this.setState({\n            errorMessage: data.error,\n            disabled: true,\n            loading: false\n          });\n        }\n      }\n    };\n\n    this.checkingRole = (role, id) => {\n      for (const key in role) {\n        if (role[key].id.toString().trim() === id.toString().trim()) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    this.onChangeCheck = e => {\n      const profileUserAll = Object.assign({}, this.state.listAllRolePermission);\n      const profileUser = Object.assign({}, this.state.listRolePermission);\n      const profileUserNew = [];\n      let flag = false;\n      let name = '';\n      let modules = '';\n\n      for (const key in profileUserAll) {\n        if (profileUserAll[key].id.toString().trim() === e.target.value.toString().trim()) {\n          name = profileUserAll[key].name;\n          modules = profileUserAll[key].modules;\n\n          for (const keyRole in profileUser) {\n            if (profileUser[keyRole].id.toString().trim() !== e.target.value.toString().trim()) {\n              profileUserNew.push(profileUser[keyRole]);\n            } else {\n              flag = true;\n            }\n          }\n        }\n      }\n\n      if (!flag) {\n        profileUserNew.push({\n          id: e.target.value,\n          name: name,\n          modules: modules\n        });\n      }\n\n      this.setState({\n        listRolePermission: profileUserNew\n      });\n    };\n\n    this.onChangeDropDown = e => {\n      this.setState({\n        role: e.target.value\n      });\n    };\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.refresh();\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  componentWillReceiveProps(newProps) {\n    this.setState({\n      errorMessage: newProps.error\n    });\n  }\n\n  render() {\n    if (this.state.diKlik) {\n      return React.createElement(Redirect, {\n        to: \"/listRolePermission\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      });\n    } else if (this.state.loading) {\n      return React.createElement(\"div\", {\n        key: \"zz\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        align: \"center\",\n        colSpan: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(Loader, {\n        type: \"Circles\",\n        color: \"#00BFFF\",\n        height: \"40\",\n        width: \"40\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      })));\n    } else if (cookie.get('token')) {\n      return React.createElement(\"div\", {\n        className: \"container mt-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"Role Permission - Tambah\"), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }), React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"col-sm-2 col-form-label\",\n        style: {\n          lineHeight: 3.5\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, \"Role Name\"), React.createElement(\"div\", {\n        className: \"col-sm-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(DropDown, {\n        value: this.state.role,\n        label: \"Role\",\n        data: this.state.listRole,\n        id: \"id\",\n        labelName: \"name\",\n        onChange: this.onChangeDropDown,\n        fullWidth: true,\n        error: this.state.roleHelper,\n        disabled: this.state.disabled,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"form-group row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12\",\n        style: {\n          color: \"red\",\n          fontSize: \"15px\",\n          textAlign: 'left'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, this.state.errorMessage), React.createElement(\"div\", {\n        className: \"col-12\",\n        style: {\n          color: \"black\",\n          fontSize: \"15px\",\n          textAlign: 'left'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(CheckBox, {\n        label: \"Core - Permission Setup\",\n        modulesName: \"Menu\",\n        data: this.state.listAllRolePermission,\n        id: \"id\",\n        labelName: \"label\",\n        modules: \"menu\",\n        labelPlacement: \"top\",\n        onChange: this.onChangeCheck,\n        onChecked: id => this.checkingRole(this.state.listRolePermission, id),\n        style: {\n          width: '97%'\n        },\n        disabled: this.state.disabled,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"form-group row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-sm-12 ml-3 mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"button\",\n        value: \"Simpan\",\n        className: \"btn btn-success\",\n        onClick: this.btnSave,\n        disabled: this.state.disabled,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        type: \"button\",\n        value: \"Batal\",\n        className: \"btn ml-2\",\n        onClick: this.btnCancel,\n        style: {\n          backgroundColor: \"grey\",\n          color: \"white\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      })))));\n    } else if (!cookie.get('token')) {\n      return React.createElement(Redirect, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      });\n    }\n  }\n\n}\n\nexport function mapDispatchToProps(dispatch) {\n  return {//   getSourceTransaction: () => {\n    //     dispatch(sourceTransactionRequest());\n    //   handleRedirect: (route) => {\n    //     dispatch(push(route));\n    //   },\n  };\n}\nexport const mapStateToProps = createStructuredSelector({// user: getUserState(),\n});\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\nconst withStyle = withStyles(styles);\nexport default compose(withConnect, withStyle, withRouter)(rolePermissionAdd);","map":{"version":3,"sources":["C:/Users/pc/Desktop/asira_core/src/components/rolePermission/rolePermissionAdd.js"],"names":["React","Cookies","Redirect","Loader","CheckBox","DropDown","swal","createStructuredSelector","connect","withRouter","withStyles","compose","listAllRolePermission","getAllRoleFunction","getAllRolePermissionAddFunction","postRolePermissionFunction","constructRolePermission","styles","theme","container","flexGrow","cookie","rolePermissionAdd","Component","_isMounted","state","diKlik","errorMessage","listRolePermission","disabled","role","listRole","loading","refresh","param","data","error","setState","dataRole","btnCancel","btnSave","length","dataRolePermission","role_id","parseInt","permissions","postRolePermission","checkingRole","id","key","toString","trim","onChangeCheck","e","profileUserAll","Object","assign","profileUser","profileUserNew","flag","name","modules","target","value","keyRole","push","onChangeDropDown","componentDidMount","componentWillUnmount","componentWillReceiveProps","newProps","render","get","lineHeight","roleHelper","color","fontSize","textAlign","width","backgroundColor","mapDispatchToProps","dispatch","mapStateToProps","withConnect","withStyle"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport Cookies from 'universal-cookie';\r\nimport { Redirect } from 'react-router-dom'\r\nimport Loader from 'react-loader-spinner'\r\nimport CheckBox from '../subComponent/CheckBox';\r\nimport DropDown from '../subComponent/DropDown';\r\nimport swal from 'sweetalert';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter } from 'react-router';\r\nimport { withStyles } from '@material-ui/styles';\r\nimport { compose } from 'redux';\r\nimport { listAllRolePermission } from './../global/globalConstant'\r\nimport { getAllRoleFunction, getAllRolePermissionAddFunction, postRolePermissionFunction } from './saga'\r\nimport { constructRolePermission } from './function'\r\n\r\nconst styles = (theme) => ({\r\n    container: {\r\n      flexGrow: 1,\r\n    },\r\n  });\r\n\r\nconst cookie = new Cookies();\r\n\r\n\r\n\r\nclass rolePermissionAdd extends React.Component{\r\n    _isMounted = false;\r\n\r\n    state = {\r\n      diKlik:false,\r\n      errorMessage:'',\r\n      listAllRolePermission,\r\n      listRolePermission: [],\r\n      disabled: false,\r\n      role : '',\r\n      listRole: [],\r\n      loading: true,\r\n    };\r\n\r\n    componentDidMount(){\r\n      this._isMounted = true;\r\n      this.refresh()\r\n    }\r\n\r\n    componentWillUnmount() {\r\n      this._isMounted = false;\r\n    }\r\n\r\n    refresh = async function(){\r\n      const param = {};\r\n\r\n      const data = await getAllRoleFunction(param, getAllRolePermissionAddFunction);\r\n\r\n      if(data) {\r\n        if(!data.error) {\r\n          this.setState({\r\n            listRole: data.dataRole,\r\n            role: data.role,\r\n            loading: false,\r\n          })\r\n        } else {\r\n          this.setState({\r\n            errorMessage: data.error,\r\n            disabled: true,\r\n            loading: false,\r\n          })\r\n        }      \r\n      }\r\n    }\r\n\r\n    btnCancel = ()=>{\r\n      this.setState({diKlik:true})\r\n    }\r\n\r\n    componentWillReceiveProps(newProps){\r\n      this.setState({errorMessage:newProps.error})\r\n    }\r\n\r\n    btnSave = () => {\r\n      if(this.state.listRolePermission.length === 0) {\r\n        this.setState({errorMessage:\"ERROR : Data Role Permission Tidak Boleh Kosong\"})\r\n      } else if(this.state.listRole.length === 0 || this.state.role === 0) {\r\n        this.setState({errorMessage:\"ERROR : Data Role Tidak Boleh Kosong\"})\r\n      } else{\r\n        const listRolePermission = this.state.listRolePermission;\r\n        const dataRolePermission = {};\r\n        dataRolePermission.role_id = parseInt(this.state.role);\r\n        dataRolePermission.permissions = constructRolePermission(listRolePermission);\r\n\r\n        const param = {\r\n          dataRolePermission,\r\n        };\r\n  \r\n        this.postRolePermission(param);\r\n        \r\n      }\r\n    }\r\n\r\n    postRolePermission = async function (param) {\r\n      const data = await postRolePermissionFunction(param)\r\n  \r\n      this.setState({loading: true})\r\n\r\n      if(data) {\r\n        if(!data.error) {\r\n          swal(\"Success\",\"Role Permission berhasil di tambah\",\"success\")\r\n          this.setState({\r\n            diKlik: true,\r\n            loading: false,\r\n          })\r\n        } else {\r\n          this.setState({\r\n            errorMessage: data.error,\r\n            disabled: true,\r\n            loading: false,\r\n          })\r\n        }      \r\n      }\r\n    }\r\n\r\n    checkingRole = (role, id) => {\r\n      for (const key in role) {\r\n        if (\r\n          role[key].id.toString().trim() === id.toString().trim()\r\n        ) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n\r\n    onChangeCheck = (e) => {\r\n      const profileUserAll = Object.assign({}, this.state.listAllRolePermission);\r\n      const profileUser = Object.assign({}, this.state.listRolePermission);\r\n      const profileUserNew = [];\r\n      let flag = false;\r\n      let name = '';\r\n      let modules = '';\r\n  \r\n      for (const key in profileUserAll) {\r\n        if (\r\n          profileUserAll[key].id.toString().trim() ===\r\n          e.target.value.toString().trim()\r\n        ) {\r\n          name = profileUserAll[key].name;\r\n          modules = profileUserAll[key].modules;\r\n\r\n          for(const keyRole in profileUser) {\r\n            if(profileUser[keyRole].id.toString().trim() !== e.target.value.toString().trim()) {\r\n              profileUserNew.push(profileUser[keyRole])\r\n            } else {\r\n              flag = true;\r\n            }\r\n          }\r\n        } \r\n      }\r\n  \r\n      if (!flag) {\r\n        profileUserNew.push({\r\n          id: e.target.value,\r\n          name: name,\r\n          modules: modules,\r\n        });\r\n      }\r\n      \r\n      this.setState({\r\n        listRolePermission: profileUserNew,\r\n      });\r\n    };\r\n\r\n    onChangeDropDown = (e) => {\r\n      this.setState({role: e.target.value})\r\n    }\r\n\r\n    render(){\r\n        if(this.state.diKlik){\r\n          return <Redirect to='/listRolePermission'/>            \r\n        } else if (this.state.loading){\r\n          return  (\r\n            <div  key=\"zz\">\r\n              <div align=\"center\" colSpan={6}>\r\n                <Loader \r\n                  type=\"Circles\"\r\n                  color=\"#00BFFF\"\r\n                  height=\"40\"\t\r\n                  width=\"40\"\r\n                />   \r\n              </div>\r\n            </div>\r\n          )\r\n        } else if(cookie.get('token')){\r\n          return(\r\n              <div className=\"container mt-4\">\r\n                <h3>Role Permission - Tambah</h3>\r\n                \r\n                <hr/>\r\n                \r\n                <form>\r\n                  <div className=\"form-group row\">                   \r\n                      <label className=\"col-sm-2 col-form-label\" style={{lineHeight:3.5}}>\r\n                        Role Name\r\n                      </label>\r\n                      <div className=\"col-sm-4\">\r\n                        <DropDown\r\n                          value={this.state.role}\r\n                          label=\"Role\"\r\n                          data={this.state.listRole}\r\n                          id=\"id\"\r\n                          labelName=\"name\"\r\n                          onChange={this.onChangeDropDown}\r\n                          fullWidth\r\n                          error={this.state.roleHelper}\r\n                          disabled={this.state.disabled}\r\n                        />\r\n                      </div>                 \r\n                  </div>\r\n\r\n                  <div className=\"form-group row\">\r\n                      <div className=\"col-12\" style={{color:\"red\",fontSize:\"15px\",textAlign:'left'}}>\r\n                        {this.state.errorMessage}\r\n                      </div>     \r\n                      <div className=\"col-12\" style={{color:\"black\",fontSize:\"15px\",textAlign:'left'}}>\r\n                        <CheckBox\r\n                          label=\"Core - Permission Setup\"\r\n                          modulesName=\"Menu\"\r\n                          data={this.state.listAllRolePermission}\r\n                          id=\"id\"\r\n                          labelName=\"label\"\r\n                          modules=\"menu\"      \r\n                          labelPlacement= \"top\"                       \r\n                          onChange={this.onChangeCheck}\r\n                          onChecked={(id) => this.checkingRole(this.state.listRolePermission, id)}\r\n                          style={{ width: '97%'}}\r\n                          disabled={this.state.disabled}\r\n                        />\r\n                      </div>           \r\n                  </div>\r\n                  \r\n                  <div className=\"form-group row\">\r\n                      <div className=\"col-sm-12 ml-3 mt-3\">\r\n                        <input type=\"button\" value=\"Simpan\" className=\"btn btn-success\" onClick={this.btnSave} disabled={this.state.disabled}/>\r\n                        <input type=\"button\" value=\"Batal\" className=\"btn ml-2\" onClick={this.btnCancel} style={{backgroundColor:\"grey\",color:\"white\"}}/>\r\n                      </div>\r\n                  </div>\r\n                  \r\n                </form>\r\n              \r\n              </div>\r\n          )\r\n        } else if(!cookie.get('token')){\r\n          return (\r\n              <Redirect to='/login' />\r\n          )    \r\n        }\r\n       \r\n    }\r\n}\r\n\r\nexport function mapDispatchToProps(dispatch) {\r\n    return {\r\n    //   getSourceTransaction: () => {\r\n    //     dispatch(sourceTransactionRequest());\r\n    //   handleRedirect: (route) => {\r\n    //     dispatch(push(route));\r\n    //   },\r\n    };\r\n}\r\n  \r\nexport const mapStateToProps = createStructuredSelector({\r\n  // user: getUserState(),\r\n});\r\n\r\nconst withConnect = connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n);\r\n\r\nconst withStyle = withStyles(styles);\r\n\r\nexport default compose(\r\n    withConnect,\r\n    withStyle,\r\n    withRouter\r\n  )(rolePermissionAdd);"]},"metadata":{},"sourceType":"module"}